<!--
  Generated template for the ShopPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header id="main-header">
  <ion-navbar>
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title><ion-searchbar [(ngModel)]="text"
      [showCancelButton]="shouldShowCancel"
      (ionInput)="onInput($event)"
      (ionCancel)="onCancel($event)"
      placeholder="Buscar Productos"></ion-searchbar></ion-title>
  </ion-navbar>
</ion-header>


<ion-content padding #contentRef >

  <div class="page-header" id="page-header">
    <div class="header-bg" id="header-bg" [ngStyle]="{'background-image': 'url(' + shop.bannerUrl + ')'}"></div>
    <div class="ph-card-box">
      <ion-card>
        <ion-card-content>
          <ion-card-title>{{shop.name}}</ion-card-title>
          <ion-grid>
            <ion-row>
              <ion-col col-6>
                <div class="price-box">
                  <p class="price">
                    <ion-icon ios="ios-bicycle" md="md-bicycle"></ion-icon>
                    <span>$ {{price.toFixed(2)}}</span>
                  </p>
                </div>
              </ion-col>
              <ion-col col-6>
                <div class="distance-box">
                  <p class="distance">
                    <ion-icon ios="ios-pin" md="md-pin"></ion-icon>
                    <span>{{distance.toFixed(2)}}km</span>
                  </p>
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-card-content>
      </ion-card>
    </div>
  </div>


    <ion-row *ngIf="text.length > 0">
      <h3 *ngIf="text.length > 0" class="menuC">Resultados para "{{text}}"</h3>
      <p *ngIf="results.length == 0 && results.length == 0">Lo sentmos no encontramos resultado para tu busqueda :(</p>
      <ion-col col-12>
        <ion-item *ngFor="let product of results" class="itemList">
          <ion-thumbnail item-left>
            <span *ngIf="isInCart(productobjectID)" class="numP">{{getCount(product.objectID)}}</span>
            <img [src]="product.imageUrl" onerror="this.src='assets/img/shopping-bag.svg';" class="productImg">
            <ion-icon *ngIf="isInCart(product.objectID)" (click)="removeToCart(product.objectID)" ios="ios-remove-circle" md="md-remove-circle"
              class="controls" style="
                  margin-top: 2.6em;
              "></ion-icon>
          </ion-thumbnail>
          <ion-grid>
            <ion-row class="price-container">
              <ion-col col-10 class="title-container">
                <h2 class="title">{{product.product}} </h2>
              </ion-col>
              <ion-col col-2 style="text-align: center;">
                <p class="price">${{product.price.toFixed(2)}}</p>
              </ion-col>
            </ion-row>

          </ion-grid>
          <ion-row class="description-row">
            <ion-col col-10 class="description-container">
              <p class="description">{{product.description}}</p>
            </ion-col>
          </ion-row>
          <ion-icon (click)="addToCart(product.objectID)" ios="ios-add-circle" md="md-add-circle" class="controls" style="
                  right: 0.6em;
              "></ion-icon>

        </ion-item>
      </ion-col>
    </ion-row>
    <div style="height:100%">
        <ion-list [virtualScroll]="products" [headerFn]="myHeaderFn" [approxItemHeight]=" '50px'" bufferRatio="2">
            <h3 *virtualHeader="let header" class="menuC">
                {{ header }}
            </h3>
            
          <ion-item *virtualItem="let product" class="itemList">
            <ion-thumbnail item-left>
              <span *ngIf="isInCart(product.$key)" class="numP">{{getCount(product.$key)}}</span>
              <img [src]="product.imageUrl" class="productImg">
              <ion-icon *ngIf="isInCart(product.$key)" (click)="removeToCart(product.$key)" ios="ios-remove-circle" md="md-remove-circle"
                class="controls" style="
                margin-top: 2.6em;
            "></ion-icon>
            </ion-thumbnail>
            <ion-grid>
              <ion-row class="price-container">
                <ion-col col-10 class="title-container">
                  <h2 class="title">{{product.product}} </h2>
                </ion-col>
                <ion-col col-2 style="text-align: center;">
                  <p class="price">${{product.price.toFixed(2)}}</p>
                </ion-col>
              </ion-row>

            </ion-grid>
            <ion-row class="description-row">
              <ion-col col-10 class="description-container">
                <p class="description">{{product.description}}</p>
              </ion-col>
            </ion-row>
            <ion-icon (click)="addToCart(product.$key)" ios="ios-add-circle" md="md-add-circle" class="controls" style="
                right: 0.6em;
            "></ion-icon>

          </ion-item>
        </ion-list>
  </div>

</ion-content>
<ion-footer class="cart" (click)="carT()" *ngIf="!empty">



  <ion-icon name="md-cart"></ion-icon>
  <span>(${{total.toFixed(2)}}) Ver carrito</span>
</ion-footer>